{"version":3,"sources":["webpack:///./src/routes/system/CategoryManage.jsx"],"names":["formItemLayout","labelCol","span","wrapperCol","CategoryManage","visible","current","title","dataIndex","render","text","record","parent","categoryName","react__WEBPACK_IMPORTED_MODULE_16___default","a","createElement","dayjs","format","className","onClick","_this","handleToEdit","antd_es_popconfirm__WEBPACK_IMPORTED_MODULE_15__","cancelText","okText","onConfirm","handleConfirmDelete","setState","_this$props","props","validateFields","form","dispatch","categoryState","err","values","_categoryState$curren","_categoryState$curren2","id","type","payload","category","prevState","_asyncToGenerator","regeneratorRuntime","mark","_callee","wrap","_context","prev","next","stop","this","React","Component","_categoryState$curren3","_categoryState$curren4","_categoryState$curren5","_categoryState$curren6","_this$props2","getFieldDecorator","state","Fragment","antd_es_button__WEBPACK_IMPORTED_MODULE_13__","handleToAdd","antd_es_table__WEBPACK_IMPORTED_MODULE_11__","rowKey","columns","getColumns","pagination","dataSource","list","antd_es_modal__WEBPACK_IMPORTED_MODULE_1__","onCancel","handleCancel","onOk","handleConfirm","antd_es_form__WEBPACK_IMPORTED_MODULE_7__","layout","Item","_extends","label","initialValue","antd_es_input__WEBPACK_IMPORTED_MODULE_9__","url","parentId","antd_es_select__WEBPACK_IMPORTED_MODULE_5__","map","c","Option","key","value","priority","antd_es_input_number__WEBPACK_IMPORTED_MODULE_3__","precision","connect","_ref2","create","mapPropsToFields"],"mappings":"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","file":"static/js/14.a3f79647.js","sourcesContent":["import React from 'react';\nimport { Table, Popconfirm, Modal, Form, Input, InputNumber, Select, Button } from 'antd';\nimport { connect } from 'react-redux';\nimport dayjs from 'dayjs';\n\nconst formItemLayout = {\n  labelCol: { span: 4 },\n  wrapperCol: { span: 12 },\n};\n\nclass CategoryManage extends React.Component {\n  state = {\n    visible: false,\n    current: null,\n  };\n\n  componentDidMount() {\n    const { dispatch } = this.props;\n    dispatch({ type: 'category/getList' });\n  }\n\n  render() {\n    const {\n      categoryState,\n      form: { getFieldDecorator },\n    } = this.props;\n    const { visible } = this.state;\n    const { current } = categoryState;\n\n    return (\n      <>\n        <div>\n          <Button type=\"primary\" onClick={this.handleToAdd}>\n            添加目录\n          </Button>\n        </div>\n        <Table\n          rowKey=\"id\"\n          columns={this.getColumns()}\n          pagination={categoryState.pagination}\n          dataSource={categoryState.list}\n        />\n        <Modal\n          visible={visible}\n          title={current ? '更新目录' : '增加目录'}\n          onCancel={this.handleCancel}\n          onOk={this.handleConfirm}\n        >\n          <Form layout=\"vertical\">\n            <Form.Item label=\"名称\" {...formItemLayout}>\n              {getFieldDecorator('categoryName', {\n                initialValue: categoryState.current?.categoryName,\n              })(<Input />)}\n            </Form.Item>\n            <Form.Item label=\"地址\" {...formItemLayout}>\n              {getFieldDecorator('url', { initialValue: categoryState.current?.url })(<Input />)}\n            </Form.Item>\n            <Form.Item label=\"父级目录\" {...formItemLayout}>\n              {getFieldDecorator('parentId', { initialValue: categoryState.current?.parentId })(\n                <Select>\n                  {categoryState.list.map((c) => (\n                    <Select.Option key={c.id} value={c.id}>\n                      {c.categoryName}\n                    </Select.Option>\n                  ))}\n                </Select>\n              )}\n            </Form.Item>\n            <Form.Item label=\"优先级\" {...formItemLayout}>\n              {getFieldDecorator('priority', {\n                initialValue: categoryState.current?.priority,\n              })(<InputNumber precision={0} />)}\n            </Form.Item>\n          </Form>\n        </Modal>\n      </>\n    );\n  }\n\n  getColumns = () => {\n    return [\n      {\n        title: '父节点ID',\n        dataIndex: 'parentId',\n        render: (text, record) => {\n          return text ? record.parent.categoryName : '-';\n        },\n      },\n      { title: '菜单名称', dataIndex: 'categoryName' },\n      { title: '地址', dataIndex: 'url' },\n      { title: '优先级', dataIndex: 'priority' },\n      {\n        title: '更新时间',\n        dataIndex: 'updateTime',\n        render: (text) => <span>{dayjs(text).format('YYYY-MM-DD hh:mm:ss')}</span>,\n      },\n      {\n        title: '操作',\n        render: (text, record) => (\n          <div className=\"anvil-btn\">\n            <a onClick={this.handleToEdit(record)}>修改</a>\n            <Popconfirm\n              title=\"是否继续?\"\n              cancelText=\"取消\"\n              okText=\"确定\"\n              onConfirm={this.handleConfirmDelete(record)}\n            >\n              <a>删除</a>\n            </Popconfirm>\n          </div>\n        ),\n      },\n    ];\n  };\n\n  handleToAdd = () => {\n    this.setState({ visible: true });\n  };\n\n  handleConfirm = () => {\n    const {\n      form: { validateFields },\n      dispatch,\n      categoryState,\n    } = this.props;\n    validateFields((err, values) => {\n      if (!err) {\n        if (categoryState.current?.id) values.id = categoryState.current?.id;\n        dispatch({ type: 'category/updateCategory', payload: { category: values, current: null } });\n\n        this.setState({ visible: false });\n      }\n    });\n  };\n\n  handleCancel = () => {\n    this.setState((prevState) => ({ visible: !prevState.visible }));\n  };\n\n  handleToEdit = (record) => {\n    return () => {\n      const { dispatch } = this.props;\n      dispatch({ type: 'category/setState', payload: { current: record } });\n      this.setState({ visible: true });\n    };\n  };\n\n  handleConfirmDelete = (record) => {\n    return async () => {\n      const { dispatch } = this.props;\n      await dispatch({ type: 'category/deleteCategory', payload: record });\n    };\n  };\n}\n\nexport default connect(({ categoryState }) => ({ categoryState }))(\n  Form.create({\n    mapPropsToFields: (props) => props.current,\n  })(CategoryManage)\n);\n"],"sourceRoot":""}