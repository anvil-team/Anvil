(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{"6a0S":function(e,t,n){e.exports={box:"anvil-search-box__box___16M9-"}},"7sTU":function(e,t,n){"use strict";var a=n("q1tI"),r=n.n(a),o=n("6a0S"),i=n.n(o);t.a=function(e){return r.a.createElement("div",{className:i.a.box},e.children)}},D0dy:function(e,t,n){"use strict";n.d(t,"a",function(){return l});var a=n("q1tI"),r=n.n(a),o=n("bJi6"),i=n.n(o);function l(e){return r.a.createElement("div",{className:i.a["blank-content"]},e.children)}},uroq:function(e,t,n){"use strict";n.r(t);n("y8nQ");var a=n("Vl3Y"),r=(n("T2oS"),n("W9HT")),o=(n("+L6B"),n("2/Rp")),i=(n("5NDa"),n("5rEg")),l=n("q1tI"),c=n.n(l),u=n("/MKj"),s=n("D0dy"),d=n("7sTU"),f=n("Y+p1"),p=n.n(f),y=(n("g9YV"),n("wCAj")),h=(n("miYZ"),n("tsqr")),m=(n("P2fV"),n("NJEC")),b=(n("/zsF"),n("PArb"));function v(e){return(v="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function g(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},a=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),a.forEach(function(t){O(e,t,n[t])})}return e}function w(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function E(e){return(E=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function S(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function C(e,t){return(C=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function O(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var P=function(e){function t(e){var n,a,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),a=this,r=E(t).call(this,e),n=!r||"object"!==v(r)&&"function"!==typeof r?S(a):r,O(S(n),"index",0),O(S(n),"cacheOriginData",{}),O(S(n),"toggleEditable",function(e){return function(t){t.preventDefault();var a=n.state.data.map(function(e){return g({},e)}),r=n.getRowByKey(e,a);r&&(r.editable||(n.cacheOriginData[e]=g({},r)),r.editable=!r.editable,n.setState({data:a}))}}),O(S(n),"handleAddRole",function(){var e=n.state.data.map(function(e){return g({},e)});e.push({id:"NEW_TEMP_ID_".concat(n.index),roleCode:"",roleName:"",roleDesc:"",editable:!0,isNew:!0}),n.index+=1,n.setState({data:e})}),O(S(n),"getColumns",function(){return[{title:"\u89d2\u8272\u4ee3\u7801",width:"35%",dataIndex:"roleCode",render:function(e,t){return t.editable?c.a.createElement(i.a,{value:e,autoFocus:!0,onChange:n.handleFieldChange("roleCode",t.id),onKeyPress:n.handleKeyPress(t.id),placeholder:"\u89d2\u8272\u4ee3\u7801"}):e}},{title:"\u89d2\u8272\u540d\u79f0",width:"20%",dataIndex:"roleName",render:function(e,t){return t.editable?c.a.createElement(i.a,{value:e,onChange:n.handleFieldChange("roleName",t.id),onKeyPress:n.handleKeyPress(t.id),placeholder:"\u89d2\u8272\u540d\u79f0"}):e}},{title:"\u89d2\u8272\u63cf\u8ff0",width:"30%",dataIndex:"roleDesc",render:function(e,t){return t.editable?c.a.createElement(i.a,{value:e,onChange:n.handleFieldChange("roleDesc",t.id),onKeyPress:n.handleKeyPress(t.id),placeholder:"\u89d2\u8272\u540d\u79f0"}):e}},{title:"\u64cd\u4f5c",key:"action",render:function(e,t){var a=n.state.loading;return t.editable&&a?null:t.editable?t.isNew?c.a.createElement("span",null,c.a.createElement("a",{onClick:n.handleSaveRow(t.id)},"\u6dfb\u52a0"),c.a.createElement(b.a,{type:"vertical"}),c.a.createElement(m.a,{title:"\u662f\u5426\u8981\u5220\u9664\u6b64\u884c\uff1f",onConfirm:n.handleRemove(t)},c.a.createElement("a",null,"\u5220\u9664"))):c.a.createElement("span",null,c.a.createElement("a",{onClick:n.handleSaveRow(t.id)},"\u4fdd\u5b58"),c.a.createElement(b.a,{type:"vertical"}),c.a.createElement("a",{onClick:n.handleCancel(t.id)},"\u53d6\u6d88")):c.a.createElement("span",null,c.a.createElement("a",{onClick:n.toggleEditable(t.id)},"\u7f16\u8f91"),c.a.createElement(b.a,{type:"vertical"}),c.a.createElement("a",{onClick:n.handleToDistributionProject(t)},"\u5206\u914d\u6743\u9650"),c.a.createElement(b.a,{type:"vertical"}),c.a.createElement(m.a,{title:"\u662f\u5426\u8981\u5220\u9664\u6b64\u884c\uff1f",onConfirm:n.handleRemove(t)},c.a.createElement("a",null,"\u5220\u9664")))}}]}),O(S(n),"handleToDistributionProject",function(e){return function(){var t=n.props.dispatch;t({type:"user/setUserVis",payload:{data:{distributionVis:!0}}}),t({type:"user/setState",payload:{userNow:e}}),t({type:"user/fetchUserApplicationAssign"})}}),n.state={data:e.value,loading:!1,value:e.value},n}var n,a,r;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&C(e,t)}(t,l["PureComponent"]),n=t,r=[{key:"getDerivedStateFromProps",value:function(e,t){return p()(e.value,t.value)?null:{data:e.value,value:e.value}}}],(a=[{key:"getRowByKey",value:function(e,t){var n=this.state.data;return(t||n).filter(function(t){return t.id===e})[0]}},{key:"handleRemove",value:function(e){var t=this;return function(){var n=t.state.data,a=t.props.onChange,r=n.filter(function(t){return t.id!==e.id});t.setState({data:r}),e.isNew||(e.isDel=!0,a(e))}}},{key:"handleKeyPress",value:function(e){var t=this;return function(n){"Enter"===n.key&&t.handleSaveRow(n,e)}}},{key:"handleFieldChange",value:function(e,t){var n=this;return function(a){var r=n.state.data.map(function(e){return g({},e)}),o=n.getRowByKey(t,r);o&&(a.target?(o[e]=a.target.value,n.setState({data:r})):(o[e]=a,n.setState({data:r})))}}},{key:"handleSaveRow",value:function(e){var t=this;return function(n){n.persist(),t.setState({loading:!0}),setTimeout(function(){if(t.clickedCancel)t.clickedCancel=!1;else{var a=t.getRowByKey(e)||{};if(!a.roleName||!a.roleCode)return h.a.error("\u8bf7\u586b\u5199\u5b8c\u6574\u89d2\u8272\u4fe1\u606f\u3002"),n.target.focus(),void t.setState({loading:!1});delete a.isNew,delete a.id,t.toggleEditable(n,e),(0,t.props.onChange)(a),t.setState({loading:!1})}},500)}}},{key:"handleCancel",value:function(e){var t=this;return function(n){t.clickedCancel=!0,n.preventDefault();var a=t.state.data.map(function(e){return g({},e)}),r=t.getRowByKey(e,a);t.cacheOriginData[e]&&(Object.assign(r,t.cacheOriginData[e]),delete t.cacheOriginData[e]),r.editable=!1,t.setState({data:a}),t.clickedCancel=!1}}},{key:"render",value:function(){var e=this.state,t=e.loading,n=e.data;return c.a.createElement(l.Fragment,null,c.a.createElement(y.a,{rowKey:"id",loading:t,columns:this.getColumns(),dataSource:n,pagination:!1,size:"middle"}),c.a.createElement(o.a,{style:{width:"100%",marginTop:16,marginBottom:8},type:"dashed",onClick:this.handleAddRole,icon:"plus"},"\u65b0\u589e\u89d2\u8272"))}}])&&w(n.prototype,a),r&&w(n,r),t}();O(P,"defaultProps",{onChange:function(){}});var j=Object(u.connect)(function(e){return{userState:e.userState}})(P);function k(e){return(k="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},a=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),a.forEach(function(t){x(e,t,n[t])})}return e}function D(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function R(e){return(R=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function K(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function N(e,t){return(N=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function x(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var T=function(e){function t(){var e,n,a,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var o=arguments.length,i=new Array(o),l=0;l<o;l++)i[l]=arguments[l];return a=this,r=(e=R(t)).call.apply(e,[this].concat(i)),n=!r||"object"!==k(r)&&"function"!==typeof r?K(a):r,x(K(n),"handleChange",function(e){var t=n.props.dispatch,a=_({},e);a.editable&&delete a.editable,e.isDel?t({type:"permission/fetchDelRole",payload:a}):t({type:"permission/fetchEditRole",payload:a})}),x(K(n),"handleSearchChange",function(e){var t=n.props;(0,t.dispatch)({type:"permission/setState",payload:{roleQuery:_({},t.permissionState.roleQuery,{roleCode:e.target.value})}})}),x(K(n),"handleSearch",function(){(0,n.props.dispatch)({type:"permission/fetchRoleList"})}),x(K(n),"handleClose",function(e){return function(){(0,n.props.dispatch)({type:"user/setUserVis",payload:{data:x({},e,!1)}})}}),n}var n,a,l;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&N(e,t)}(t,c.a.Component),n=t,(a=[{key:"componentDidMount",value:function(){(0,this.props.dispatch)({type:"permission/fetchRoleList"})}},{key:"render",value:function(){var e=this.props.permissionState,t=e.roleList,n=e.roleListLoading;return c.a.createElement(c.a.Fragment,null,c.a.createElement(s.a,null,c.a.createElement(d.a,null,c.a.createElement(i.a,{style:{width:200,marginRight:10},placeholder:"\u8bf7\u8f93\u5165",onChange:this.handleSearchChange,onPressEnter:this.handleSearch}),c.a.createElement(o.a,{type:"primary",onClick:this.handleSearch},"\u641c\u7d22")),c.a.createElement(r.a,{spinning:n},c.a.createElement(j,{value:t,pagination:!1,onChange:this.handleChange}))))}}])&&D(n.prototype,a),l&&D(n,l),t}();t.default=Object(u.connect)(function(e){return{permissionState:e.permissionState}})(a.a.create()(T))}}]);
//# sourceMappingURL=13.c7c9d133.js.map