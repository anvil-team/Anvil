<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.godman.anvil.dao.AnvilUserDao">

	<resultMap id="AnvilUserResultMap" type="AnvilUser">
		<result property="username" column="username" />
		<result property="password" column="password" />
		<association property="role" javaType="AnvilRole" resultMap="AnvilRoleResultMap" />
	</resultMap>

	<resultMap id="AnvilRoleResultMap" type="AnvilRole">
		<result property="roleName" column="role_name" />
	</resultMap>

	<select id="findByUsername" parameterType="Map" resultMap="AnvilUserResultMap">
		SELECT
		u.username,
		u.password,
		r.role_name
		FROM anvil_user u, anvil_role r
		WHERE u.username=#{username} and r.id=u.role
	</select>

</mapper>