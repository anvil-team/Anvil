<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.godman.anvil.dao.AnvilApplicationDao">

	<select id="findByPaging" parameterType="Map" resultType="AnvilApplication">
		SELECT
		a.id,
		a.application_code,
		a.application_name,
		a.description,
		a.person_in_charge as chargePersonId,
		(SELECT real_name FROM anvil_user WHERE id=a.person_in_charge) as chargePersonName,
		a.should_reviewed,
		a.create_time,
		a.update_time 
		FROM anvil_application a 
		<if test="applicationName!='' and applicationName != null">
		where a.application_name like '%${applicationName}%' 
		</if>
		limit #{pageStart},#{pageSize}
	</select>
	
	<select id="getSize" parameterType="Map" resultType="Integer">
		SELECT
		count(1)
		FROM anvil_application a
	</select>
	
	<insert id="addApplication" parameterType="AnvilApplication">
		INSERT INTO anvil_application
		(application_code,
		application_name,
		description,
		person_in_charge,
		should_reviewed,
		create_time,
		update_time
		)
		VALUES
		(#{applicationCode},
		#{applicationName},
		#{description},
		#{personInCharge},
		#{shouldReviewed},
		now(),
		now()
		)
	</insert>
	
	<update id="updateApplication" parameterType="AnvilApplication">
		UPDATE  anvil_application SET
		application_name=#{applicationName},
		description=#{description},
		person_in_charge=#{personInCharge},
		update_time=now() 
		WHERE id=#{id}
	</update>
	
	<delete id="deleteApplication" parameterType="Map">
		DELETE FROM anvil_application 
		WHERE id=#{applicationId}
	</delete>
	
</mapper>